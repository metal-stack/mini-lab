---

- name: deploy configuration
  template:
    src: "{{ item }}.j2"
    dest: /etc/sonic/frr/{{ item }}
  loop:
    - bgpd.conf
    - staticd.conf
    - zebra.conf
  notify: bgp restart

- name: install services
  copy:
    src: "{{ item }}"
    dest: "/etc/systemd/system/{{ item }}"
  notify: reload systemd
  with_items:
    - bgp-validation@.service
    - write-to-db@.service

- name: deploy metal-core's configdb snippet
  template:
    src: metal-core.json.j2
    dest: /etc/sonic/metal-core.json
  notify: write metal-core.json into db
