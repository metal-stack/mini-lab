---
# this is the static part of the partition inventory
# the connection details for leaf vms are provided dynamically
# by the vagrant inventory plugin
partition:
  hosts:
    localhost:
      ansible_python_interpreter: "{{ ansible_playbook_python }}"
  children:
    leaves:
    mgmtservers:

leaves:
  hosts:
    leaf01:
      lo: 10.0.0.11
      asn: 4200000011
      metal_core_cidr: 10.0.1.1/24
      dhcp_net: 10.0.1.0
      dhcp_netmask: 255.255.255.0
      dhcp_range_min: 10.0.1.2
      dhcp_range_max: 10.0.1.255
    leaf02:
      lo: 10.0.0.12
      asn: 4200000012
      metal_core_cidr: 10.0.1.128/24
  vars:
    ports:
      1: 100G
      2: 100G
      3: 100G
    interfaces:
    - name: swp1
    - name: swp2
    - name: swp3
    uplinks: []
    dhcp_server_ip: 10.0.1.1

    ansible_python_interpreter: /usr/bin/python

    # The best practice recommendation is to set an MTU of 9,216 for the inter-switch links,
    # and an MTU of 9,000 for the server-facing ports, which donâ€™t carry the VXLAN header.
    # See: EVPN in the Data center (D. Dutt, p.77)
    mtu:
      vxlan: 9216
      default: 9000

mgmtservers:
  hosts:
    mgmtserver01:
      spine_facing_iface_ip: 10.1.253.13
      firewall_facing_iface_ip: "{{ hostvars['mgmtfw01'].ips.mgmt_srv }}"
      switch_mgmt_ip: 10.1.253.13
      firewall_ip: "{{ hostvars['mgmtfw01'].ips.edgerouter.mgmt_srv_eth0 }}"
      asn: 4200000001
      dhcp_subnets: "{{ dhcp_subnets_server01 + dhcp_subnets_common }}"
      dhcp_subnets_server01:
        -
          comment: "tenant server IPMI at r01mgmtleaf01"
          network: 10.1.1.0
          netmask: 255.255.255.0
          range:
            begin: 10.1.1.10
            end: 10.1.1.128
          options:
            - 'option routers 10.1.1.1;'
        -
          comment: "tenant server IPMI at r01mgmtleaf11"
          network: 10.1.2.0
          netmask: 255.255.255.0
          range:
            begin: 10.1.2.10
            end: 10.1.2.128
          options:
            - 'option routers 10.1.2.1;'
    mgmtserver02:
      spine_facing_iface_ip: 10.1.253.29
      firewall_facing_iface_ip: "{{ hostvars['mgmtfw02'].ips.mgmt_srv }}"
      switch_mgmt_ip: 10.1.253.29
      firewall_ip: "{{ hostvars['mgmtfw02'].ips.edgerouter.mgmt_srv_eth0 }}"
      asn: 4200000002
      dhcp_subnets: "{{ dhcp_subnets_server02 + dhcp_subnets_common }}"
      dhcp_subnets_server02:
        -
          comment: "tenant server IPMI at r01mgmtleaf01"
          network: 10.1.1.0
          netmask: 255.255.255.0
          range:
            begin: 10.1.1.129
            end: 10.1.1.254
          options:
            - 'option routers 10.1.1.1;'
        -
          comment: "tenant server IPMI at r01mgmtleaf11"
          network: 10.1.2.0
          netmask: 255.255.255.0
          range:
            begin: 10.1.2.129
            end: 10.1.2.254
          options:
            - 'option routers 10.1.2.1;'

vagrant:
  vars:
    ansible_become: yes
